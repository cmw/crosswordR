<% title "Home" %>

<% if current_user %>

	<div class="homeFolder">
		<h2>Solutions in Progress</h2>
		<% if current_user.crossword_solutions_count > 0 %>
				<% current_user.crossword_solutions.all(:order => 'created_at DESC').each do |sol| %>
				<div>
						<%= link_to sol.crossword_puzzle.title + ' by ' + sol.crossword_puzzle.user, edit_crossword_puzzle_path(sol.crossword_puzzle) %>
				</div>
				<% end %>
		<% else %>
			You haven't attempted any puzzles yet!
		<% end %>
	</div>
	
	<div class="homeFolder">
		<h2>My Puzzles</h2>
		<% if current_user.crossword_puzzles_count > 0 %>
				<% if current_user.crossword_puzzles.where(:published => false).count > 0 %>
					<h3>Unpublished</h3>
					<% current_user.crossword_puzzles.where(:published => false).each do |puz| %>
					<div class="homeFolderItem">
							<%= puz.title %> -- <%= puz.rows %>x<%= puz.cols %> -- <%= puz.created_at.strftime("%d %b. %Y") %>
							<%= link_to "<span class='right'>View</span>".html_safe, crossword_puzzle_path(puz) %>
							<%= link_to "<span class='right'>Edit</span>".html_safe, edit_crossword_puzzle_path(puz) %>
			
					</div>
					<% end %>
				<% end %>
				
				<% if current_user.crossword_puzzles.where(:published => true).count > 0 %>
					<h3>Published</h3>
					<% current_user.crossword_puzzles.where(:published => true).each do |puz| %>
					<div class="homeFolderItem">
							<%= puz.title %> -- <%= puz.rows %>x<%= puz.cols %> -- <%= puz.created_at.strftime("%d %b. %Y") %>
							<%= link_to "<span class='right'>View</span>".html_safe, crossword_puzzle_path(puz) %>
							<%= link_to "<span class='right'>Edit</span>".html_safe, edit_crossword_puzzle_path(puz) %>
			
					</div>
					<% end %>
				<% end %>
		<% else %>
				You haven't created any puzzles yet!
		<% end %>
	</div>

<% else %>
		<style type="text/css">
			body {
				/*
				Image from http://1.bp.blogspot.com/-4DwniCCS8VY/T2ZyfO9FNTI/AAAAAAAAAPU/dsi7k3ux20M/s640/lenox+coffee+interior.jpg
				*/
				background: url(/assets/couchCafe.jpg) no-repeat;
				background-size: 100%;
				background-position: center 2em;
			}
			html {
				background: black;
			}
		</style>
		<div id="logged-out-welcome-container">
			<div id="welcomeBoard"></div>
			<%= form_tag sessions_path do %>
			<p>
				<%= text_field_tag :username, params[:username], :placeholder => "username", :class => "chalkboardInput" %>
			</p>
			<p>
				<%= password_field_tag :password , nil,  :class => "chalkboardInput", :placeholder => "password" %>
			</p>
				<%= submit_tag "LOG IN" , :class => "chalkboardButton" %>
		<% end %>
			<span>or</span><br /><br /><br />
			<%= link_to "SIGN UP".html_safe, sign_up_path, :class => "chalkboardButton" %>			
		</div>
<% end %>